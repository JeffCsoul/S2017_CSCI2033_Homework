% HW 8 Question 8
% 8.(a)
A = [0 0 0 0 1 1 0 0 0;
0 0 1 0 1 1 0 0 0;
0 1 0 0 0 1 1 0 0;
0 0 0 0 0 0 0 1 0;
1 1 0 0 0 1 0 0 0;
1 1 1 0 1 0 1 0 0;
0 0 1 0 0 1 0 1 0;
0 0 0 1 0 0 1 0 1;
0 0 0 0 0 0 0 1 0]

A =

     0     0     0     0     1     1     0     0     0
     0     0     1     0     1     1     0     0     0
     0     1     0     0     0     1     1     0     0
     0     0     0     0     0     0     0     1     0
     1     1     0     0     0     1     0     0     0
     1     1     1     0     1     0     1     0     0
     0     0     1     0     0     1     0     1     0
     0     0     0     1     0     0     1     0     1
     0     0     0     0     0     0     0     1     0


d = 3.2607

d =

    3.2607

v = [ .2892 .4115 .3988 .0384 .3858 .5572 .3316 .1253 .0384]'

v =

    0.2892
    0.4115
    0.3988
    0.0384
    0.3858
    0.5572
    0.3316
    0.1253
    0.0384

v = v/.5572

v =

    0.5190
    0.7385
    0.7157
    0.0689
    0.6924
    1.0000
    0.5951
    0.2249
    0.0689


k = 0

k =

     0

x = [1 1 1 1 1 1 1 1 1]'

x =

     1
     1
     1
     1
     1
     1
     1
     1
     1

x = A * x;
[maxAbs, eigenvalueIndex] = max(abs(x));
eigenvalue = v(eigenvalueIndex)

eigenvalue =

     1

x = (1.0/eigenvalue) * x;
d = 0;
while (abs(eigenvalue - d) > .0001)
    k = k + 1
    d = eigenvalue;
    x
    x = A * x;
    [maxAbs, eigenvalueIndex] = max(abs(x));
    eigenvalue = x(eigenvalueIndex)
    x = (1.0/eigenvalue) * x;
end

k =

     1


x =

     2
     3
     3
     1
     3
     5
     3
     3
     1


eigenvalue =

    14


k =

     2


x =

    0.5714
    0.7857
    0.7857
    0.2143
    0.7143
    1.0000
    0.7857
    0.3571
    0.2143


eigenvalue =

    3.6429


k =

     3


x =

    0.4706
    0.6863
    0.7059
    0.0980
    0.6471
    1.0000
    0.5882
    0.3333
    0.0980


eigenvalue =

    3.0980


k =

     4


x =

    0.5316
    0.7595
    0.7342
    0.1076
    0.6962
    1.0000
    0.6582
    0.2532
    0.1076


eigenvalue =

    3.3797


k =

     5


x =

    0.5019
    0.7191
    0.7154
    0.0749
    0.6779
    1.0000
    0.5880
    0.2584
    0.0749


eigenvalue =

    3.2022


k =

     6


x =

    0.5240
    0.7474
    0.7205
    0.0807
    0.6936
    1.0000
    0.6164
    0.2304
    0.0807


eigenvalue =

    3.3018


k =

     7


x =

    0.5129
    0.7311
    0.7159
    0.0698
    0.6879
    1.0000
    0.5909
    0.2356
    0.0698


eigenvalue =

    3.2388


k =

     8


x =

    0.5212
    0.7422
    0.7169
    0.0727
    0.6929
    1.0000
    0.6025
    0.2255
    0.0727


eigenvalue =

    3.2757


k =

     9


x =

    0.5168
    0.7357
    0.7158
    0.0688
    0.6910
    1.0000
    0.5930
    0.2283
    0.0688


eigenvalue =

    3.2522


k =

    10


x =

    0.5199
    0.7400
    0.7160
    0.0702
    0.6926
    1.0000
    0.5978
    0.2247
    0.0702


eigenvalue =

    3.2664


k =

    11


x =

    0.5182
    0.7374
    0.7157
    0.0688
    0.6919
    1.0000
    0.5941
    0.2260
    0.0688


eigenvalue =

    3.2573


k =

    12


x =

    0.5194
    0.7391
    0.7158
    0.0694
    0.6925
    1.0000
    0.5961
    0.2246
    0.0694


eigenvalue =

    3.2629


k =

    13


x =

    0.5187
    0.7381
    0.7157
    0.0688
    0.6922
    1.0000
    0.5947
    0.2252
    0.0688


eigenvalue =

    3.2593


k =

    14


x =

    0.5192
    0.7388
    0.7157
    0.0691
    0.6924
    1.0000
    0.5955
    0.2247
    0.0691


eigenvalue =

    3.2616


k =

    15


x =

    0.5189
    0.7383
    0.7157
    0.0689
    0.6923
    1.0000
    0.5949
    0.2250
    0.0689


eigenvalue =

    3.2601


k =

    16


x =

    0.5191
    0.7386
    0.7157
    0.0690
    0.6924
    1.0000
    0.5953
    0.2248
    0.0690


eigenvalue =

    3.2610


k =

    17


x =

    0.5190
    0.7384
    0.7157
    0.0689
    0.6923
    1.0000
    0.5950
    0.2249
    0.0689


eigenvalue =

    3.2605


k =

    18


x =

    0.5190
    0.7385
    0.7157
    0.0690
    0.6924
    1.0000
    0.5952
    0.2248
    0.0690


eigenvalue =

    3.2608


k =

    19


x =

    0.5190
    0.7385
    0.7157
    0.0689
    0.6923
    1.0000
    0.5951
    0.2248
    0.0689


eigenvalue =

    3.2606


k =

    20


x =

    0.5190
    0.7385
    0.7157
    0.0690
    0.6924
    1.0000
    0.5951
    0.2248
    0.0690


eigenvalue =

    3.2607


k =

    21


x =

    0.5190
    0.7385
    0.7157
    0.0689
    0.6923
    1.0000
    0.5951
    0.2248
    0.0689


eigenvalue =

    3.2606
% -----------------------------------------------------------------------------
% 8.(b)
x = [1 1 1 1 1 1 1 1 1]'

x =

     1
     1
     1
     1
     1
     1
     1
     1
     1

k = -1;
x = x/norm(x, 2);
eigenvalue = 10000;
d = 0;
while (abs(eigenvalue - d) > .0001)
d = eigenvalue;
k = k + 1
x
y = A * x;
eigenvalue = dot(x, y)
x = y / norm(y, 2);
end

k =

     0


x =

    0.3333
    0.3333
    0.3333
    0.3333
    0.3333
    0.3333
    0.3333
    0.3333
    0.3333


eigenvalue =

    2.6667


k =

     1


x =

    0.2294
    0.3441
    0.3441
    0.1147
    0.3441
    0.5735
    0.3441
    0.3441
    0.1147


eigenvalue =

    3.1053


k =

     2


x =

    0.2891
    0.3974
    0.3974
    0.1084
    0.3613
    0.5058
    0.3974
    0.1807
    0.1084


eigenvalue =

    3.2141


k =

     3


x =

    0.2679
    0.3907
    0.4018
    0.0558
    0.3684
    0.5693
    0.3349
    0.1898
    0.0558


eigenvalue =

    3.2457


k =

     4


x =

    0.2882
    0.4117
    0.3979
    0.0583
    0.3774
    0.5420
    0.3568
    0.1372
    0.0583


eigenvalue =

    3.2556


k =

     5


x =

    0.2821
    0.4043
    0.4022
    0.0421
    0.3811
    0.5622
    0.3306
    0.1453
    0.0421


eigenvalue =

    3.2589


k =

     6


x =

    0.2894
    0.4127
    0.3979
    0.0446
    0.3830
    0.5522
    0.3404
    0.1272
    0.0446


eigenvalue =

    3.2600


k =

     7


x =

    0.2868
    0.4089
    0.4003
    0.0390
    0.3847
    0.5592
    0.3304
    0.1317
    0.0390


eigenvalue =

    3.2604


k =

     8


x =

    0.2895
    0.4123
    0.3982
    0.0404
    0.3849
    0.5555
    0.3347
    0.1253
    0.0404


eigenvalue =

    3.2606


k =

     9


x =

    0.2884
    0.4105
    0.3994
    0.0384
    0.3856
    0.5580
    0.3309
    0.1274
    0.0384


eigenvalue =

    3.2606

% -----------------------------------------------------------------------------
% Question 9
% 9.(a)
A= [2.0475 3.1849 0.5783
2.1421 3.1736 0.5775
2.0479 3.1536 0.5687
2.0483 3.1362 0.5715
2.1075 3.1872 0.5701
2.0975 3.1812 0.5815
2.0832 3.1675 0.5829
2.0553 3.1732 0.5734
2.0499 3.1559 0.5691
2.0563 3.1652 0.5873]

A =

    2.0475    3.1849    0.5783
    2.1421    3.1736    0.5775
    2.0479    3.1536    0.5687
    2.0483    3.1362    0.5715
    2.1075    3.1872    0.5701
    2.0975    3.1812    0.5815
    2.0832    3.1675    0.5829
    2.0553    3.1732    0.5734
    2.0499    3.1559    0.5691
    2.0563    3.1652    0.5873


rec = 999999;
recl = 0;
recr = 0;
for i = 1:9
    for j = (i+1):9
        a = [A(i,1:3)]';
        b = [A(j,1:3)]';
        ra = acos(dot(a,b)/(norm(a) * norm(b)));
        if (ra < rec)
            rec = ra;
            recl = i;
            recr = j;
        end
    end
end
[recl, recr]

ans =

     3     9

rec

rec =

   1.1255e-04

% -----------------------------------------------------------------------------
% 9.(b)
rec = 0;
recl = 0;
recr = 0;
for i = 1:9
    for j = (i+1):9
        a = [A(i,1:3)]';
        b = [A(j,1:3)]';
        ra = acos(dot(a,b)/(norm(a) * norm(b)));
        if (ra > rec)
            rec = ra;
            recl = i;
            recr = j;
        end
    end
end
[recl, recr]

ans =

     1     2

rec

rec =

    0.0222

% -----------------------------------------------------------------------------
% Question 10
% 10.(a)
a1 = [2 -3;3 2] \ [5;2]

a1 =

    1.2308
   -0.8462

a2 = [2 -3;2.1 -3] \ [5;2]

a2 =

  -30.0000
  -21.6667

% 10.(b)
b1  = [2.01 -3;3 2] \ [5;2]

b1 =

    1.2289
   -0.8433

b2 = [2.01 -3;2.1 -3] \ [5;2]

b2 =

  -33.3333
  -24.0000

% 10.(c)
c1 = norm(a1 - b1)

c1 =

    0.0034

c2 = norm(a2 - b2)

c2 =

    4.0689

% 10.(d)
cond1 = cond([2 -3 5;
3 2 2])

cond1 =

    1.7974

cond2  = cond([2 -3 5;
2.1 -3 2])

cond2 =

    4.7801

% 10.(e)
% There exists a significant difference between the two distances in 10.(c)
% Because the condition number of system (2) is much greater than the condition number of system (1). This would be result in that even just a small same amount change on one coefficient for each system, the solution for system (2) would have more changes compared with the corresponding change of system (1)'s solution
