% Problem 8.(a)
C=[0.1588 0.0064 0.0025 0.0304 0.0014 0.0083 0.1594;
0.0057 0.2645 0.0436 0.0099 0.0083 0.0201 0.3413;
0.0264 0.1506 0.3557 0.0139 0.0142 0.0070 0.0236;
0.3299 0.0565 0.0495 0.3636 0.0204 0.0483 0.0649;
0.0089 0.0081 0.0333 0.0295 0.3412 0.0237 0.0020;
0.1190  0.0901 0.0996 0.1260 0.1722 0.2368 0.3369;
0.0063 0.0126 0.0196 0.0098 0.0064 0.0132 0.0012]

C =

    0.1588    0.0064    0.0025    0.0304    0.0014    0.0083    0.1594
    0.0057    0.2645    0.0436    0.0099    0.0083    0.0201    0.3413
    0.0264    0.1506    0.3557    0.0139    0.0142    0.0070    0.0236
    0.3299    0.0565    0.0495    0.3636    0.0204    0.0483    0.0649
    0.0089    0.0081    0.0333    0.0295    0.3412    0.0237    0.0020
    0.1190    0.0901    0.0996    0.1260    0.1722    0.2368    0.3369
    0.0063    0.0126    0.0196    0.0098    0.0064    0.0132    0.0012

d =[74000;56000;10500;25000;17500;196000;5000]

d =

       74000
       56000
       10500
       25000
       17500
      196000
        5000

Cinv = inv(C)

Cinv =

    9.4831   -0.4493   -2.6028   -1.2548    0.8185   -3.8561   68.3990
    2.3563    3.6594   -3.5648   -0.7752    0.9653   -4.7156   80.5343
   -1.2994   -1.5271    4.3426    0.2685   -0.4927    1.9295  -33.8721
   -8.7289    0.1358    2.3982    4.1571   -0.6790    3.2723  -68.6846
    0.4801    0.1444   -0.2366   -0.1916    3.1029   -0.3414    0.8588
    1.5537   -1.2147   -3.6874   -2.1074   -1.5203    0.9098   72.7050
   -1.6685    0.3607    2.4047    0.5956   -0.6650    3.3322  -61.5379

(Cinv - eye(7)) \ (Cinv * d)

ans =

   1.0e+05 *

    0.9958
    0.9770
    0.5123
    1.3157
    0.4949
    3.2955
    0.1384

% Problem 8.(b)
xans = (Cinv - eye(7)) \ (Cinv * d)

xans =

   1.0e+05 *

    0.9958
    0.9770
    0.5123
    1.3157
    0.4949
    3.2955
    0.1384

x = d

x =

       74000
       56000
       10500
       25000
       17500
      196000
        5000

i = 0

i =

     0

flag = 0

flag =

     0

while (flag == 0)
  i = i + 1;
  x = d + C * x;
  for j = 1:7
    if (abs(x(j,1) - xans(j,1)) <= 0.01)
	  flag = flag + 1;
	end
  end
  if (flag == 7)
	flag = 7;
  else
    flag = 0;
  end
end
k = i

k =

    26

% Problem 9.(a)
trans = [1 0 0 -.5;
0 1 0 -.5;
0 0 1 0
0 0 0 1]

trans =

    1.0000         0         0   -0.5000
         0    1.0000         0   -0.5000
         0         0    1.0000         0
         0         0         0    1.0000

rotat = [cos(72/180*pi) -sin(72/180*pi) 0 0;
sin(72/180*pi) cos(72/180*pi) 0 0 ;
0 0 1 0;
0 0 0 1]

rotat =

    0.3090   -0.9511         0         0
    0.9511    0.3090         0         0
         0         0    1.0000         0
         0         0         0    1.0000

scaling = [1 0 0 0;
0 1 0 0;
0 0 5 0;
0 0 0 1]

scaling =

     1     0     0     0
     0     1     0     0
     0     0     5     0
     0     0     0     1

trans2 = [1 0 0 100;
0 1 0 50;
0 0 1 -80;
0 0 0 1]

trans2 =

     1     0     0   100
     0     1     0    50
     0     0     1   -80
     0     0     0     1

proj = [1 0 0 0;
0 1 0 0;
0 0 0 0;
0 0 -1/35 1]

proj =

    1.0000         0         0         0
         0    1.0000         0         0
         0         0         0         0
         0         0   -0.0286    1.0000

% Problem 9.(b)
T = proj * trans2 * scaling *rotat*trans

T =

     0.3090   -0.9511         0  100.3210
     0.9511    0.3090         0   49.3700
          0         0         0         0
          0         0   -0.1429    3.2857

% Problem 9.(c)
V = [0 0 0 0 1 1 1 1;
0 0 1 1 0 0 1 1;
0 1 0 1 0 1 0 1;
1 1 1 1 1 1 1 1]

V =

     0     0     0     0     1     1     1     1
     0     0     1     1     0     0     1     1
     0     1     0     1     0     1     0     1
     1     1     1     1     1     1     1     1

Vans = T * V

Vans =

  100.3210  100.3210   99.3700   99.3700  100.6300  100.6300   99.6790   99.6790
   49.3700   49.3700   49.6790   49.6790   50.3210   50.3210   50.6300   50.6300
         0         0         0         0         0         0         0         0
    3.2857    3.1429    3.2857    3.1429    3.2857    3.1429    3.2857    3.1429

Vans1 = []

Vans1 =

     []

for i = 1:8
Vans1 = [Vans1 Vans(1:4,i)/Vans(4,i)];
end
Vans1

Vans1 =

   30.5325   31.9203   30.2430   31.6177   30.6265   32.0186   30.3371   31.7160
   15.0256   15.7086   15.1197   15.8069   15.3151   16.0112   15.4091   16.1096
         0         0         0         0         0         0         0         0
    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000
    
% Problem 10.(a)
F = [0    0.2000    0.2000    0.2000    0.1000    0.1000    0.1000    0.1000;
    0.2000         0    0.2000    0.2000    0.1000    0.1000    0.1000    0.1000;
    0.2000    0.2000         0    0.2000    0.1000    0.1000    0.1000    0.1000;
    0.2000    0.2000    0.2000         0    0.1000    0.1000    0.1000    0.1000;
    0.2000    0.2000    0.2000    0.2000         0         0    0.1100    0.0900;
    0.2000    0.2000    0.2000    0.2000         0         0    0.0900    0.1100;
    0.2000    0.2000    0.2000    0.2000    0.1100    0.0900         0         0;
    0.2000    0.2000    0.2000    0.2000    0.0900    0.1100         0         0]

F =

         0    0.2000    0.2000    0.2000    0.1000    0.1000    0.1000    0.1000
    0.2000         0    0.2000    0.2000    0.1000    0.1000    0.1000    0.1000
    0.2000    0.2000         0    0.2000    0.1000    0.1000    0.1000    0.1000
    0.2000    0.2000    0.2000         0    0.1000    0.1000    0.1000    0.1000
    0.2000    0.2000    0.2000    0.2000         0         0    0.1100    0.0900
    0.2000    0.2000    0.2000    0.2000         0         0    0.0900    0.1100
    0.2000    0.2000    0.2000    0.2000    0.1100    0.0900         0         0
    0.2000    0.2000    0.2000    0.2000    0.0900    0.1100         0         0

p = [0.00 0.42 0.53 0.82 0.24 0.77 0.88 0.10]

p =

         0    0.4200    0.5300    0.8200    0.2400    0.7700    0.8800    0.1000

E = [0.93 0.85 0.89;0 0 0;0 0 0;0 0 0;0.5 0.5 0.5;0 0 0;0 0 0 ;0.44 0.44 0.44]

E =

    0.9300    0.8500    0.8900
         0         0         0
         0         0         0
         0         0         0
    0.5000    0.5000    0.5000
         0         0         0
         0         0         0
    0.4400    0.4400    0.4400

pM = diag(p)

pM =

         0         0         0         0         0         0         0         0
         0    0.4200         0         0         0         0         0         0
         0         0    0.5300         0         0         0         0         0
         0         0         0    0.8200         0         0         0         0
         0         0         0         0    0.2400         0         0         0
         0         0         0         0         0    0.7700         0         0
         0         0         0         0         0         0    0.8800         0
         0         0         0         0         0         0         0    0.1000

x = inv(eye(8) - (pM * F)) * E

x =

    0.9300    0.8500    0.8900
    0.2086    0.1963    0.2024
    0.2579    0.2428    0.2504
    0.3792    0.3569    0.3680
    0.6062    0.5993    0.6027
    0.3421    0.3201    0.3311
    0.3983    0.3731    0.3857
    0.4847    0.4818    0.4833

% Problem 10.(b)
% 1. Yes, all components are between 0.0 and 1.0
% 2. First patch has the largest red component. First patch has the largest green component. First patch has the largest blue component.

