% Homework 9
% Problem 8
% 8.(a)

A = [ 0 .707 1
-.707 0 .707
-1 -.707 0
-.707 -1 -.707
0 -.707 -1
.707 0 -.707
1 .707 0
.707 1 .707
0 -.707 1
.707 0 -.707
-1 .707 0
.707 -1 .707
0 .707 -1
-.707 0 .707
1 -.707 0
-.707 1 -.707]

A =

         0    0.7070    1.0000
   -0.7070         0    0.7070
   -1.0000   -0.7070         0
   -0.7070   -1.0000   -0.7070
         0   -0.7070   -1.0000
    0.7070         0   -0.7070
    1.0000    0.7070         0
    0.7070    1.0000    0.7070
         0   -0.7070    1.0000
    0.7070         0   -0.7070
   -1.0000    0.7070         0
    0.7070   -1.0000    0.7070
         0    0.7070   -1.0000
   -0.7070         0    0.7070
    1.0000   -0.7070         0
   -0.7070    1.0000   -0.7070

b = [.707 0 -.707 -1 -.707 0 .707 1 0 0 0 0 0 0 0 0]'

b =

    0.7070
         0
   -0.7070
   -1.0000
   -0.7070
         0
    0.7070
    1.0000
         0
         0
         0
         0
         0
         0
         0
         0

A\b

ans =

    0.3536
    0.5000
    0.3536

% 8.(b)
x = inv(A' * A) * A' * b

x =

    0.3536
    0.5000
    0.3536

pdist([x A\b]','euclidean')

ans =

   7.8505e-17

% 8.(c)
[Q,R]= qr(A)

Q =

  Columns 1 through 10

         0   -0.2500   -0.3536    0.4328    0.3000   -0.0086   -0.3121   -0.4328   -0.1708   -0.0086
    0.2500    0.0000   -0.2500    0.2122    0.2914    0.2000   -0.0086   -0.2122    0.1086    0.2000
    0.3536    0.2500   -0.0000   -0.1329    0.1122    0.2914    0.3000    0.1329   -0.3828    0.2914
    0.2500    0.3536    0.2500    0.8000   -0.1914   -0.0707    0.0914    0.2000    0.0500   -0.0707
         0    0.2500    0.3536   -0.0914    0.8500   -0.1207   -0.0207    0.0914    0.0854   -0.1207
   -0.2500   -0.0000    0.2500    0.0707   -0.0207    0.9000   -0.1207   -0.0707    0.0707   -0.1000
   -0.3536   -0.2500   -0.0000    0.1914    0.1207   -0.0207    0.8500   -0.1914    0.0146   -0.0207
   -0.2500   -0.3536   -0.2500    0.2000    0.1914    0.0707   -0.0914    0.8000   -0.0500    0.0707
         0    0.2500   -0.3536   -0.0500    0.0147    0.0707    0.0854    0.0500    0.8250    0.0707
   -0.2500   -0.0000    0.2500    0.0707   -0.0207   -0.1000   -0.1207   -0.0707    0.0707    0.9000
    0.3536   -0.2500    0.0000   -0.0500    0.0146    0.0707    0.0854    0.0500    0.0750    0.0707
   -0.2500    0.3536   -0.2500   -0.0000    0.0000    0.0000    0.0000    0.0000   -0.1768    0.0000
         0   -0.2500    0.3536    0.0500   -0.0147   -0.0707   -0.0854   -0.0500    0.1750   -0.0707
    0.2500    0.0000   -0.2500   -0.0707    0.0207    0.1000    0.1207    0.0707   -0.0707    0.1000
   -0.3536    0.2500   -0.0000    0.0500   -0.0146   -0.0707   -0.0854   -0.0500   -0.0750   -0.0707
    0.2500   -0.3536    0.2500    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.1768   -0.0000

  Columns 11 through 16

    0.1829   -0.2500    0.1708    0.0086   -0.1829    0.2500
   -0.3914    0.3536   -0.1086   -0.2000    0.3914   -0.3536
   -0.0293   -0.2500    0.3828   -0.2914    0.0293    0.2500
    0.0500   -0.0000   -0.0500    0.0707   -0.0500    0.0000
    0.0854    0.0000   -0.0854    0.1207   -0.0854   -0.0000
    0.0707    0.0000   -0.0707    0.1000   -0.0707   -0.0000
    0.0147    0.0000   -0.0146    0.0207   -0.0147    0.0000
   -0.0500    0.0000    0.0500   -0.0707    0.0500   -0.0000
    0.0750   -0.1768    0.1750   -0.0707   -0.0750    0.1768
    0.0707    0.0000   -0.0707    0.1000   -0.0707   -0.0000
    0.8250    0.1768   -0.0750   -0.0707    0.1750   -0.1768
    0.1768    0.7500    0.1768   -0.0000   -0.1768    0.2500
   -0.0750    0.1768    0.8250    0.0707    0.0750   -0.1768
   -0.0707   -0.0000    0.0707    0.9000    0.0707    0.0000
    0.1750   -0.1768    0.0750    0.0707    0.8250    0.1768
   -0.1768    0.2500   -0.1768    0.0000    0.1768    0.7500


R =

   -2.8282    0.0000    0.0000
         0   -2.8282    0.0000
         0         0   -2.8282
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0

R\(Q'*b)

ans =

    0.3536
    0.5000
    0.3536

% Problem 9
% 9.(a)
y = [111.98
113.54
112.89
110.69
113.62
114.35
118.77
121.19
118.40
121.33
122.67
123.64
124.07
124.49
120.19
120.38
117.50
118.75
120.50
125.09
123.66
121.55
123.90
123.00
122.34
119.65
121.89
120.56
122.04
122.04
121.26
127.17
132.75
132.30
130.33
132.35
132.39
134.07
137.73
138.10
138.91
138.12
140.00
143.75
143.70
134.89
137.26
146.00
143.85
141.43
131.76
135.00
136.49
131.85
135.25
135.03
134.01
126.39
125.00
127.79
124.03
119.90
117.05
122.06
122.22
127.57
132.51];

x = [1:67]';

% best least-squares line
polyfit(x,y,1)

ans =

    0.2709  117.7299

% best least-squares quadratic
polyfit(x,y,2)

ans =

   -0.0128    1.1412  107.7215

% best least-squares cubic
polyfit(x,y,3)

ans =

   -0.0005    0.0408   -0.3283  116.3551

% 9.(b)
% least squares line difference
p = polyfit(x,y,1)

p =

    0.2709  117.7299

f = polyval(p,x);
tot = 0;
for i = 1:67
tot = tot + (y(i) - f(i))^2;
end
tot

tot =

   3.2671e+03

% least squares quadratic difference
p = polyfit(x,y,2)

p =

   -0.0128    1.1412  107.7215

f = polyval(p,x);
tot = 0;
for i = 1:67
tot = tot + (y(i) - f(i))^2;
end
tot

tot =

   2.0398e+03
   
% least squares cubic difference
p = polyfit(x,y,3)

p =

   -0.0005    0.0408   -0.3283  116.3551

f = polyval(p,x);
tot = 0;
for i = 1:67
tot = tot + (y(i) - f(i))^2;
end
tot

tot =

   1.4434e+03
  
% Problem 10
X = [(1:67)'.^0 (1:67)'.^1 (1:67)'.^2 (1:67)'.^3];
% X' * X
X' * X

ans =

   1.0e+11 *

    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0001    0.0028
    0.0000    0.0001    0.0028    0.1576
    0.0001    0.0028    0.1576    9.1172

% condition number of X' * X
cond(X' * X)

ans =

   2.4713e+11
